# Log Loss

- 모델 성능 평가 시 사용 가능한 지표
분류(Classification) 모델 평가 시 사용
- 따라서 확률 값을 직접적으로 평가지표로 활용
- 모델이 예측한 확률 값을 직접적으로 반영하여 평가
- **확률 값을 음의 log 함수에 넣어서 변환**을 시킨 값으로 평가
  -> 잘못 예측할수록, 페널티를 부여하기 위함
즉, 실제 정답에 대한 예측 확률이 낮아질수록 페널티를 더 주기 위해

[y = class 0](https://www.notion.so/ab1799049a464e73b38ef50f29286d0f)

![Untitled](https://user-images.githubusercontent.com/54128055/148557745-bcdd212b-8cef-4aa3-98c9-5644a34230cb.png)

값이 적어질수록 (-log(x) 그래프와 같이) 좋은 지표이다

확률 값은 0~1사이의 값이므로 빨간 점선 내의 값이 x 이다

100%의 확률로 정답을 확신할 시, 확률이 1일 때: -log(1.0) = 0

80%의 확률로 정답을 확신할 시, 확률이 0.8일 때: -log(0.8) = 0.22314

60%의 확률로 정답을 확신할 시, 확률이 0.6일 때: -log(0.6) = 0.51082

- 위 처럼 확률값이 0.2씩 일정하게 감소하였지만
- -log(x)의 값은 증가량이 점점 커지는 것을 알 수 있음
- log 함수의 특성에 따라 기하급수적으로 증가
    
    → 확률값이 점점 더 낮아 질 수록, 확신을 더 못할수록, log loss 값이 기하급수적으로 증가
    

model 1: -log(0.99) = 0.01005

model 2: -log(0.2) = 1.6094

- 높을수록 좋은 지표: 정답 개수, 정답 확률
- 낮을수록 좋은 지표: Log Loss

ML 분류 문제는 주어진 문제를 해결할 때 확률 값을 선출하여 최종적으로 분류할 class를 선정한다 따라서 log loss으로 평가한다면 모델을 더욱 정교하게 평가할 수 있다

[실제 값](https://www.notion.so/e43112e192c449138e7d9be08ea80bf8)

[row 별로 클래스 예측시](https://www.notion.so/56d34ca34d4c47fbae217d7ec9530c8d)

관측별로 실제 답안에 해당하는 확률 값을 음의 로그를 취하고, 평균을 냄
